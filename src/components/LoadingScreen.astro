---
---

<div id="loading-screen" class="loading-screen">
  <div class="heart-pulse-container">
      <svg width="120" height="120" viewBox="0 0 24 24" class="heart-svg">
        <defs>
          <linearGradient id="fireGradient" x1="0%" y1="100%" x2="0%" y2="0%">
            <stop offset="0%" style="stop-color:#ff3c3c;stop-opacity:1" />
            <stop offset="50%" style="stop-color:#ff7730;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#ffb830;stop-opacity:1" />
          </linearGradient>
          <mask id="fillMask">
            <rect id="fill-rect" x="0" y="24" width="24" height="24" fill="white" />
          </mask>
        </defs>
        
        <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" 
              fill="#333" />
              
        <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" 
              fill="url(#fireGradient)" mask="url(#fillMask)" />
      </svg>
  </div>
  
  <p class="loading-text">Cargando mi amorcito<span class="dots">...</span></p>
  
  <div class="progress-box">
    <div class="progress-bar-fill"></div>
  </div>
  <p class="percentage-txt">0%</p>
</div>

<style>
.loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #0a0a0a;
    z-index: 20000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: opacity 0.8s ease, visibility 0.8s;
}

.heart-pulse-container {
    animation: pulse 1s infinite alternate ease-in-out;
    margin-bottom: 2rem;
    filter: drop-shadow(0 0 15px rgba(255, 60, 60, 0.3));
}

.loading-text {
    font-family: 'Playfair Display', serif;
    font-size: 1.5rem;
    color: #fff;
    margin-bottom: 1.5rem;
    letter-spacing: 1px;
}

.progress-box {
    width: 300px;
    height: 8px;
    background: #222;
    border-radius: 10px;
    overflow: hidden;
    position: relative;
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
}

.progress-bar-fill {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #ff3c3c, #ff7730, #ffd700);
    position: relative;
    box-shadow: 0 0 15px #ff3c3c;
    transition: width 0.1s linear;
}

.percentage-txt {
    font-family: 'Courier New', monospace;
    color: #ff7730;
    margin-top: 10px;
    font-weight: bold;
}

@keyframes pulse {
    from { transform: scale(1); }
    to { transform: scale(1.1); }
}

.dots { animation: dotsAnim 1.5s infinite; }
@keyframes dotsAnim {
  0% { content: '.'; }
  33% { content: '..'; }
  66% { content: '...'; }
}
</style>

<script>
  function initLoader() {
    const screen = document.getElementById('loading-screen');
    const fillRect = document.getElementById('fill-rect');
    const bar = document.querySelector('.progress-bar-fill') as HTMLElement;
    const txt = document.querySelector('.percentage-txt');
    
    // Safety check with safer opacity read
    if(!screen) return;
    if(screen.style.opacity === '0' || screen.style.visibility === 'hidden') return;
    
    let pct = 0;
    const interval = setInterval(() => {
        pct += 3; // Even faster
        
        if(bar) bar.style.width = Math.min(pct, 100) + '%';
        if(txt) txt.textContent = Math.min(pct, 100) + '%';
        
        if (fillRect) {
            const yVal = 24 - (24 * (pct/100));
            fillRect.setAttribute('y', yVal.toString());
        }
        
        if (pct >= 100) {
            clearInterval(interval);
            setTimeout(() => {
                screen.style.opacity = '0';
                screen.style.pointerEvents = 'none'; // Immediate unblock
                setTimeout(() => {
                  screen.style.visibility = 'hidden';
                }, 500);
            }, 300);
        }
    }, 50);
  }

  // Force Start immediately
  initLoader();
  
  // Double check on load
  window.onload = initLoader;
  
  // FAILSAFE: Hard remove after 5 seconds
  setTimeout(() => {
      const screen = document.getElementById('loading-screen');
      if(screen) {
          screen.style.opacity = '0';
          screen.style.pointerEvents = 'none';
          setTimeout(() => screen.style.visibility = 'hidden', 500);
      }
  }, 5000);
</script>
