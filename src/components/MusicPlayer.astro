---
---

<div id="music-player">
  <button id="toggle-music" class="music-btn" aria-label="Reproducir/Pausar mÃºsica">
    <span class="icon">ðŸ”¥</span>
  </button>
  
  <audio id="bg-audio" loop>
    <source src="/audio/a-fuego.mp3" type="audio/mpeg">
    Tu navegador no soporta el elemento de audio.
  </audio>
</div>

<style>
  #music-player {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 1000;
  }

  .music-btn {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    border: none;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(5px);
    color: var(--fire-orange);
    font-size: 2rem;
    cursor: pointer;
    box-shadow: 0 0 15px rgba(255, 60, 60, 0.3);
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid var(--fire-red);
  }

  .music-btn:hover {
    transform: scale(1.1);
    background: rgba(0, 0, 0, 0.8);
    box-shadow: 0 0 25px rgba(255, 119, 48, 0.5);
  }

  /* Playing state animation */
  .playing {
    animation: pulse-fire 1.5s infinite;
    background: rgba(255, 60, 60, 0.2);
    border-color: var(--gold);
    color: var(--gold);
  }

  @keyframes pulse-fire {
    0% { box-shadow: 0 0 0 0 rgba(255, 60, 60, 0.7); }
    70% { box-shadow: 0 0 0 20px rgba(255, 60, 60, 0); }
    100% { box-shadow: 0 0 0 0 rgba(255, 60, 60, 0); }
  }
</style>

<script>
  const audio = document.getElementById('bg-audio') as HTMLAudioElement;
  const btn = document.getElementById('toggle-music');
  
  let isPlaying = false;

  function togglePlay() {
    if (!audio) return;
    
    if (isPlaying) {
      audio.pause();
      btn?.classList.remove('playing');
    } else {
      audio.play().catch(e => console.log("Audio play failed (interaction needed):", e));
      btn?.classList.add('playing');
    }
    isPlaying = !isPlaying;
  }

  btn?.addEventListener('click', togglePlay);

  // Listen for Hero button event
  window.addEventListener('play-music', () => {
    if (!isPlaying) togglePlay();
  });
</script>
